<link rel="import" href="elements.html">

<!--
`<uqlibrary-training-list-category>` is a simple element that displays a list of training events

Example:

    <uqlibrary-training-list-category events="{{events}}"></uqlibrary-training-category>

@demo

@demo demo/index.html Demo of the Full view
-->
<dom-module id="uqlibrary-training-list-category">

  <template>

    <style is="custom-style" include="common-styles">

      :host {
        font-family: var(--font-family);
        font-size: var(--body-font-size);

        display: block;
        position: relative;
        box-sizing: border-box;
        --paper-item-min-height: 48px;
        --paper-item-body-two-line-min-height: 72px;
      }

      .card-active {
        background: var(--menu-hover-background-color);
      }
      paper-card {
        width: 100%;
      }

      paper-item {

        --paper-item: {
          border-bottom: 1px solid var(--border-color);
        }

        --paper-item-focused: {
          background: var(--menu-hover-background-color);
        }

        --paper-item-focused-before: {
          opacity: 0;
        }

      }

      .event-date {
        min-width: 48px;
        min-width: 3rem;
        margin-right: 0;
        cursor: default;
        display: inline-flex;
      }

      /* right align the date */
      .event-date span {
        margin-left: auto;
      }

      a {
        cursor: default;
      }

      paper-icon-item .content-icon {
        display: none;
      }

      .event-line {
        @apply(--layout-horizontal);
        @apply(--layout-start-justified);
        min-height: var(--paper-item-min-height);
        line-height: var(--paper-item-min-height);
        flex-direction: column;
      }

      .event-line div {
        @apply(--layout-start);
        height: 2rem;
      }

      .event-title {
        margin-top: 12px;
        margin-top: 0.75rem;
        padding-bottom: 4px;
        padding-bottom: 0.25rem;
      }

      @media all and (max-width: 550px) {

        .event-line {
          @apply(--layout-vertical);
          min-height: var(--paper-item-body-two-line-min-height);
        }

      }

      .an-entry {
        justify-content: space-between;
        margin-top: -16px;
        margin-top: -1rem;
      }

      .body1 {
        font-size: 12px;
        font-size: 0.75rem;
        color: #676767;
        background-color: inherit;
        display: block;
        margin-top: -16px;
        margin-top: -1rem;
        margin-bottom: 12px;
        margin-bottom: 0.75rem;
      }

      .count-events {
        color: #5b5b5b;
        background-color: inherit;
      }
    </style>

    <uqlibrary-ga id="ga" app-name="[[gaAppName]]"></uqlibrary-ga>

    <paper-card heading="[[_getCategoryTitle(category.displayName, hideCategoryTitle)]]">
      <template is="dom-if" if="{{renderedCount}}">
        <div class="card-content count-events">
          [[renderedCount]] events available
        </div>
      </template>

      <template is="dom-repeat"
                items="[[category.events]]"
                as="trainingEvent"
                filter="{{filterEvents(filterCriteria.keyword, filterCriteria.week, filterCriteria.campus)}}"
                rendered-item-count="{{renderedCount}}">

        <paper-item class="an-entry" on-click="toggle" id$="item[[trainingEvent.entityId]]">

          <paper-item-body class="event-line">
              <div class="event-title"><a>[[trainingEvent.name]]</a></div>
              <div class="body1">[[ trainingEvent.venue ]]</div>
          </paper-item-body>

          <div>
            <div class="event-date">
              <span>[[_formatDate(trainingEvent.start)]]</span>
            </div>
            <iron-icon class="down" icon="icons:arrow-drop-down"></iron-icon>
            <iron-icon class="up hidden" icon="icons:arrow-drop-up"></iron-icon>
          </div>

          <paper-ripple></paper-ripple>
        </paper-item>

        <iron-collapse id$="collapse[[trainingEvent.entityId]]" data-id$="[[trainingEvent.entityId]]">
          <div class="card-active">
            <div class="card-content">
              <paper-card>
                <uqlibrary-training-details
                        ga-app-name="[[gaAppName]]"
                        user-account="[[userAccount]]"
                        event="[[trainingEvent]]"
                        show-login-button="true">
                </uqlibrary-training-details>
              </paper-card>
            </div>
          </div>
        </iron-collapse>
      </template>

      <template is="dom-if" if="{{!renderedCount}}">
        <div class="card-content no-events">
        No events available
        </div>
      </template>

    </paper-card>

  </template>

  <script src="uqlibrary-training-list-category.js"></script>

</dom-module>
